프로토콜: 통신 장치들 간에 **교환될 메시지의 형식**, **교환 순서**, **수행해야할 행위**를 정의한 것

 

계층화는 한 계층의 기능이 하위 계층과 기능적으로 중복된다.

- 링크와 종단 시스템 두 곳 모두에서 오류 복구 기능을 제공한다.

어느 한 계층에서의 기능이 다른 계층에만 존재하는 정보를 필요로 하는 경우가 있다.

프로토콜 계층화는 개념과 구조 측면에서 이점이 있다.

묘듈화를 함으로써 시스템 구성요소의 갱신을 더 쉽게 해준다.

다양한 계층의 프로토콜을 모두 합하여 프로토콜 스택이라고 한다.

(a) 인터넷 프로토콜 스택

| 애플리케이션 | 대부분 종단 시스템의 소프트웨어로 구현된다. ex) HTTP/SMTP |
| --- | --- |
| 트랜스포트 | 대부분 종단 시스템의 소프트웨어로 구현된다. |
| 네트워크 | 하드웨어와 소프트웨어로 혼합 구현된다. |
| 링크 | 네트워크 인터페이스 카드로 구현된다. |
| 물리 | 네트워크 인터페이스 카드로 구현된다. |

(b) OSI(Open System Interconnection) 참조 모델

| 애플리케이션 |
| --- |
| 프레젠테이션 |
| 세션 |
| 트랜스포트 |
| 네트워크 |
| 링크 |
| 물리 |

프레젠테이션 계층: 통신하는 애플리케이션들이 교환되는 데이터의 의미를 해석하도록 하는 서비스 제공

- 데이터 압축 + 암호화를 포함한다.
- 확장자

세션 계층: 데이터 교환의 경계와 동기화를 제공한다.

- 체킹 포인트와 회복 방법을 세우는 수단을 포함한다.

**애플리케이션 계층**

네트워크 애플리케이션과 애플리케이션 계층 프로토콜이 있는 곳

HTTP, SMTP, FTP와 같은 프로토콜을 포함한다.

대표적인 예로, DNS(Domain Name Server)가 www.ietf.org와 같은 이름을 32비트 네트워크 주소로 변환하는 기능이 있다.

애플레케이션 프로토콜은 여러 종단 시스템에 분산되어 있어서, 한 종단 시스템에 있는 애플리케이션이 다른 종단 시스템에 있는 애플리케이션과 정보 패킷을 교환할 때 이 프로토콜을 사용한다.

애플리케이션 계층에서의 정보 패킷을 메시지라고 부른다.

**트랜스포트 계층**

클라이언트와 서버 간에 애플리케이션 계층 메시지를 전송하는 서비스를 제공한다.

프로토콜로는 TCP/UDP가 있으며, 이들은 애플리케이션 계층 메시지를 전달한다.

TCP는 애플리케이션에게 연결지향형 서비스를 제공한다.

- 목적지로의 애플리케이션 계층 메시지 전달을 보장하고, 흐름제어(송신자/수신자의 속도를 일치시킴)를 포함한다.
- 긴 메시지를 짧은 메시지로 나누고 혼잡제어 기능을 제공하여, 네트워크가 혼잡할 때 출발지의 전송 속도를 줄이도록 한다.
- 순서 보장 → 오류 제어!

UDP는 애플리케이션에게 비연결형 서비스를 제공한다.

- 신뢰성, 흐름제어, 혼잡제어를 제공하지 않는 서비스

트랜스포트 계층 패킷을 세그먼트라고 한다.

**네트워크 계층**

한 호스트에서 다른 호스트로 데이터그램을 라우팅하는 책임을 진다.

출발지 호스트에서 인터넷 트랜스포트 계층 프로토콜(TCP or UDP)은 트랜스포트 계층 세그먼트와 목적지 주소를 네트워크 계층으로 전달한다.

네트워크 계층은 목적지 호스트의 트랜스포트 계층으로 세그먼트를 운반하는 서비스를 제공한다.

네트워크 계층은 두 가지 주요 요소를 갖는다.

1. **IP 데이터그램의 필드를 정의한다.**
2. **종단 시스템과 라우터가 이 필드에 어떻게 동작하는지를 정의하는 프로토콜을 갖고 있다. → IP 프로토콜네트워크 계층을 가진 모든 인터넷 요소는 IP 프로토콜을 수행해야만 한다**.
3. 출발지와 목적지 사이에서 데이터그램이 이동하는 경로를 결정하는 라우팅 프로토콜을 포함한다.

**링크 계층**

경로상의 한 노드(호스트 or 패킷 스위치)에서 다른 노드로 패킷을 이동하기 위해, 네트워크 계층은 링크 계층 서비스에 의존한다.

링크 계층은 데이터그램을 경로상의 다음 노드에 전달한다.

링크 계층에서 제공하는 서비스는 링크 계층 프로토콜에 따라 다르다.

데이터그램은 목적지로 가기 까지 여러 링크를 거치는데, 경로상의 서로 다른 링크에서 서로 다른 링크 계층 프로토콜에 의해 처리될 수 있다.

ex) 한 링크에서는 이더넷, 다음 링크에서는 PPP

링크 계층의 패킷을 프레임이라고 한다.

**물리 계층**

프레임 내부의 각 비트를 한 노드에서 다음 노드로 이동시킨다.

물리 계층의 프로토콜은 링크에 의존하며 링크의 실제 전송매체(꼬임쌍선, 단일 모드 광케이블 등)에 의존한다.

### 캡슐화

송신 호스트에서 애플리케이션 계층 메시지(M)은 트랜스포트 계층으로 보내질 때 트랜스포트 계층 헤더 정보인 ($H_t$)를 더한다.

즉, M과 $H_t$는 트랜스포트 계층 세그먼트를 구성한다.

트랜스포트 계층 세그먼트는 애플리케이션 계층 메시지를 캡슐화한다.

- 추가된 정보는 수신측의 트랜스포트 계층이 그 **메시지를 적절한 애플리케이션으로 보내도록 하는 정보**와 메시지의 비트가 변경되었는지의 유무를 판단하는 **오류 검출 비트**를 포함한다.

세그먼트를 L4 PDU(Protocol Data Unit)라고도 한다.

트랜스포트 계층은 세그먼트를 네트워크 계층 헤더 정보($H_n$)와 더하여 네트워크 계층 데이터그램을 만든다. 

데이터그램을 L3 PDU라고도 한다.

데이터 그램은 링크 계층으로 전달된다.

링크 계층도 자신의 헤더 정보($H_l$)를 추가하여 링크 계층 프레임(L2 PDU)을 만든다.

따라서, 각 계층에서 패킷은 헤더 필드와 페이로드 필드를 갖는다는 것을 알 수 있다.

각 계층에서는 해당 정보만 읽고 넘겨준다.