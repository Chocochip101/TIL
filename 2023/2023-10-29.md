# 메모리와 캐시 메모리
## RAM의 특징
- 전원이 끊기면 저장된 내용이 사라지는 휘발성 저장 장치이다.
- CPU는 비휘발성 저장 장치인 보조기억장치에 바로 접근할 수 없고 RAM에 올라간 실행할 대상에 접근한다.

## RAM의 용량과 성능
- RAM의 용량이 클 수록 많은 프로그램들을 동시에 빠르게 실행할 수 있다.
- 하지만 용량이 필요 이상으로 커진다고 속도가 그에 비례해 증가하진 않는다.

## RAM의 종류
### DRAM(Dynamic RAM)
- 저장된 데이터가 동적으로 변하는(사라지는) RAM을 의미한다.
- 시간이 지나면 저장된 데이터가 점차 사라지므로 일정 주기로 데이터를 재활성화 해야 한다.
- 소비 전력이 낮고, 저렴하며 집적도가 높아 대용량으로 설계하기에 용이하다.
### SRAM(Static RAM)
- 저장된 데이터가 변하지 않는 RAM을 의미한다.
- 시간이 지나도 저장된 내용이 소실되지 않아 DRAM에 비해 속도가 빠르다.
- 하지만 DRAM에 비해 소비 전력이 크고, 비싸며 집적도가 낮아 속도가 정말 중요한 캐시 메모리와 같은 곳에 사용된다.
### SDRAM(Synchronous Dynamic RAM)
- 클럭 신호와 동기화된, 발전된 형태의 DRAM이다.
- 클럭 타이밍에 맞춰 CPU와 정보를 주고받을 수 있다.
- 클럭 사이클 한 개 당 한 개의 명령어를 받거나, 한 워드 만큼의 데이터를 주고받을 수 있는 SDRAM을 SDR(Single Data Rate) SDRAM 이라고도 부른다.
### DDR SDRAM(Double Data Rate SDRAM)
- 가장 흔히 사용되는 RAM으로 대역폭을 넓혀 속도를 빠르게 만든 SDRAM이다.
- 대역폭이 두 배이기에 한 클럭에 두 번씩 CPU와 데이터를 주고받을 수 있다.

## 물리주소
- 정보가 실제로 저장된 하드웨어 상의 주소를 의미한다.

## 논리 주소
- CPU와 실행 중인 프로그램이 사용하는, 실행 중인 프로그램 각각에 부여된 0번지부터 시작되는 주소를 의미한다.
- 프로그램의 첫 시작 물리 주소로부터 떨어진 거리를 나타낸다.

## 메모리 관리 장치(MMU)
- CPU와 주소 버스 사이 논리 주소와 물리 주소 간의 변환을 담당하는 하드웨어
- CPU가 발생 시킨 논리 주소에 베이스 레지스터 값을 더해 논리 주소를 물리 주소로 변환한다.
## 베이스 레지스터
- 프로그램의 가장 작은, 첫 물리 주소를 저장하는 레지스터
## 메모리 보호 기법
- 프로그램이 다른 프로그램의 영역을 침범하는 일이 발생할 수 있다.
## 한계 레지스터
- 침범하는 행위를 막는 역할을 수행하는 레지스터
- 논리 주소의 최대 크기를 저장한다.
- 만약 CPU가 한계 레지스터보다 높은 논리 주소에 접근하려고 하면 인터럽트(트랩)인 memory protection fault을 발생 시켜 실행을 중단한다.
- 이 인터럽트는 CPU가 스스로 처리할 수 없는 명령어라 판단해 운영체제에 처리를 요청하는 인터럽트이다.

## 저장 장치 계층 구조
- 컴퓨터가 사용하는 저장 장치들을 ‘CPU에 얼마나 가까운가’의 기준으로 계층적으로 나타낸 구조.
- 레지스터 > 캐시 메모리 > 메모리 > 보조기억장치 순으로 빠르고, 비싸며, 용량이 작다.
## 캐시 메모리
- CPU가 직접 메모리에 접근하는 것이 아닌 CPU와 메모리 사이에 위치하며 레지스터 보다 용량이 크고, 메모리보다 빠른 SRAM 기반의 저장 장치.
- CPU가 사용할 외부 데이터를 미리 캐시 메모리로 가져와 사용할 수 있게 해준다.
- CPU(코어)와 가까운 순으로 코어 내부에 위치하는 L1캐시와 L2캐시, 코어 외부(메인 보드)에 위치하는 L3캐시라 부른다.
- L1, L2캐시는 코어마다 고유한 캐시 메모리로 할당되고, L3캐시는 여러 코어가 공유하는 형태로 사용된다.
- L1 캐시는 명령어만 저장하는 L1I, 데이터만 저장하는 L1D로 나뉘는 경우도 있어 분리형 캐시라고도 불린다.

## Direct Mapping 기법
- cache와 메모리를 매핑하는 가장 간단한 방법으로, 메모리 주소에 따라 cache에 넣을 수 있는 공간을 제한한다.
## 참조 지역성 원리
- 캐시 메모리는 CPU가 사용할 법한 대상을 예측해 저장한다.
## 캐시 히트
- 자주 사용될 것으로 예측한 데이터가 실제로 들어맞아 캐시 메모리 내 데이터가 CPU에서 활용되는 경우
## 캐시 미스
- 예측이 틀려 메모리에서 필요한 데이터를 직접 가져와야 하는 경우
## Cold miss
- 해당 메모리 주소를 처음 불러서 나는 미스
## Confilct miss
- 캐시 메모리에 A, B 데이터를 저장해야 하는데, A와 B가 같은 캐시 메모리 주소에 할당되어 있어 나는 미스(주소 할당 문제)
## Capacity miss
- 캐시 메모리의 공간이 부족해서 나는 미스(공간 문제)
## 캐시 적중률
- 캐시가 히트되는 비율로 ‘캐시 히트 횟수 / (캐시 히트 횟수 + 캐시 미스 횟수)’ 의 식으로 계산한다.
- 대부분 컴퓨터의 캐시 적중률은 85%~95% 이상이다.

## 적중률을 높이기 위한 방법
- 캐시의 크기를 늘린다.
- 지역성 이론에 기반해 앞으로 많이 사용될 데이터를 가져온다.
## 참조 지역성의 원리
- CPU가 메모리에 접근할 때의 주된 경향을 바탕으로 만들어진 원리
- CPU는 최근에 접근했던 메모리 공간에 다시 접근하려는 경향이 있다.(시간 지역성)
  - 변수를 저장하고 이를 활용할 경우
  - CPU는 접근한 메모리 공간 근처를 접근하려는 경향이 있다.(공간 지역성)
- 특정 프로그램이 모여있는 공간 근처를 집중적으로 접근하는 경우
